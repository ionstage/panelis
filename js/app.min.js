!function t(e,n,o){function i(s,l){if(!n[s]){if(!e[s]){var a="function"==typeof require&&require;if(!l&&a)return a(s,!0);if(r)return r(s,!0);var h=new Error("Cannot find module '"+s+"'");throw h.code="MODULE_NOT_FOUND",h}var c=n[s]={exports:{}};e[s][0].call(c.exports,function(t){var n=e[s][1][t];return i(n?n:t)},c,c.exports,t,e,n,o)}return n[s].exports}for(var r="function"==typeof require&&require,s=0;s<o.length;s++)i(o[s]);return i}({1:[function(t,e,n){!function(e){"use strict";var n=e.helper||t("./helper.js"),o=e.dom||t("./dom.js"),i=e.Panel||t("./components/panel.js"),r=e.Board||t("./components/board.js"),s=e.ControllerComponent||t("./components/controller-component.js"),l=e.Root||t("./components/root.js"),a=e.ControllerRelation||t("./relations/controller-relation.js"),h=e.ControllerBoardRelation||t("./relations/controller-board-relation.js"),c=function(){n.bindAll(this),this.board=new r({rowLength:8,colLength:8,element:o.el(".board"),pointer:this.pointer}),this.whiteController=new s({color:s.COLOR_WHITE,element:o.el('.controller[data-color="white"]'),okExecutor:this.okExecutor,backExecutor:this.backExecutor}),this.blackController=new s({color:s.COLOR_BLACK,element:o.el('.controller[data-color="black"]'),okExecutor:this.okExecutor,backExecutor:this.backExecutor}),this.root=new l({widthPerFontSize:66,heightPerFontSize:106,element:o.root()}),this.controllerRelation=new a({whiteController:this.whiteController,blackController:this.blackController}),this.whiteControllerBoardRelation=new h({controller:this.whiteController,board:this.board}),this.blackControllerBoardRelation=new h({controller:this.blackController,board:this.board}),this.whiteController.relations([this.controllerRelation,this.whiteControllerBoardRelation]),this.blackController.relations([this.controllerRelation,this.blackControllerBoardRelation]),this.board.reset(),this.whiteController.reset(),this.blackController.reset(),this.whiteController.fillEmptySlot(),this.whiteController.disabled(!1)};c.prototype.pointer=function(t,e){var n=this.board,o=this.controllerRelation.enabledController();if(o){var r=o.selectedPanel(),s=n.selectedPanel();if(!n.panel(t,e)&&r){o.panel(o.selectedPanelIndex(),null);var l=new i(r.props());o===this.blackController&&(l.rotate(),l.rotate()),n.panel(t,e,l),n.selectedPanel(l)}else s&&s.rotateWithAnimation().then(function(){o.markDirty()})}},c.prototype.okExecutor=function(){var t=this.board;if(!t.selectedPanel()){var e=this.root,o=this.controllerRelation,i=o.enabledController(),r=o.disabledController();return i.removePanel(i.selectedPanel()),i.disabled(!0),r.fillEmptySlot(),e.disabled(!0),void setTimeout(function(){var o=r.panels().map(function(e){return t.canSetAnyPosition(e)}).some(n.identity);o||this.endGame(),e.disabled(!1)}.bind(this),250)}this.endTurn().then(function(){t.hasEmptyPosition()||this.endGame()}.bind(this))},c.prototype.backExecutor=function(){var t=this.board,e=this.controllerRelation.enabledController(),n=t.selectedPanel();if(n){t.removePanel(n);var o=new i(n.props());o.resetRotation(),e.panel(e.emptySlotIndex(),o),e.selectedPanel(o)}},c.prototype.endTurn=function(){var t=this.board,e=this.root,o=this.controllerRelation,r=t.selectedPanel(),l=t.connectedPanels(r),a=o.enabledController(),h=o.disabledController();e.disabled(!0),t.selectedPanel(null),a.markDirty();var c=function(){return n.timeout(250)},p=function(){return t.isAllJointsConnected(r)?(r.isFixed(!0),a.incrementScore(s.SCORE_TYPE_FIX),r.flash(i.FLASH_COLOR_GREEN).then(c)):void 0},d=function(){var t=r.color(),e=l.filter(function(e){return!e.isFixed()&&e.color()!==t});return 0!==e.length?Promise.all(e.map(function(e){return e.gradateColor(t)})).then(c):void 0},u=function(){var e=l.filter(function(e){return!e.isFixed()&&t.isAllJointsConnected(e)});if(0!==e.length)return Promise.all(e.map(function(e){return e.color()===i.COLOR_GRAY?(t.removePanel(e),a.incrementScore(s.SCORE_TYPE_ERASE),r.flash(i.FLASH_COLOR_RED)):(e.isFixed(!0),a.incrementScore(s.SCORE_TYPE_FIX),e.flash(i.FLASH_COLOR_GREEN))})).then(c)},f=function(){var e=t.chainList(r);if(0!==e.length)return e.reduce(function(t,e){return t.then(function(){return Promise.all(e.map(function(t){return a.incrementScore(s.SCORE_TYPE_CHAIN),t.flash(i.FLASH_COLOR_YELLOW)}))})},Promise.resolve()).then(c)},m=function(){a.disabled(!0),h.fillEmptySlot(),e.disabled(!1)};return Promise.resolve().then(c).then(p).then(d).then(u).then(f).then(m)},c.prototype.endGame=function(){var t,e,n=this.whiteController,o=this.blackController,i=n.totalScore(),r=o.totalScore();i===r?(t="Draw",e=Math.random()<.5?n:o):(t=(i>r?"White":"Black")+" wins!",e=i>r?o:n),t+="\n\n[Score]\nWhite: "+i+"\nBlack: "+r,alert(t),this.board.reset(),n.reset(),o.reset(),e.fillEmptySlot(),e.disabled(!1)},e.main=new c}(this.app||(this.app={}))},{"./components/board.js":2,"./components/controller-component.js":3,"./components/panel.js":4,"./components/root.js":5,"./dom.js":6,"./helper.js":7,"./relations/controller-board-relation.js":8,"./relations/controller-relation.js":9}],2:[function(t,e,n){!function(n){"use strict";var o=t("jcore"),i=n.helper||t("../helper.js"),r=n.dom||t("../dom.js"),s=n.Panel||t("./panel.js"),l=function(t){this.joints=t.joints};l.prototype.hasJoint=function(t){return this.joints[t]},l.prototype.rotate=function(){this.joints.unshift(this.joints.pop())};var a=i.inherits(function(t){a.super_.call(this);var e=t.rowLength,n=t.colLength;this.rowLength=this.prop(e),this.colLength=this.prop(n),this.panels=this.prop(new Array(e*n)),this.selectedPanelIndex=this.prop(-1),this.element=this.prop(t.element),this.pointer=t.pointer;var o=a.prototype.onpoint.bind(this);r.on(this.element(),r.eventType("start"),o)},o.Component);a.prototype.panelPosition=function(t){var e=this.panels().indexOf(t),n=this.colLength(),o=-1!==e?Math.floor(e/n):-1,i=-1!==e?e%n:-1;return{row:o,col:i}},a.prototype.selectedPanel=function(t){var e=this.panels(),n=e[this.selectedPanelIndex()]||null;if("undefined"==typeof t)return n;if(t!==n){if(null===t)return void(n&&(n.isFocused(!1),this.selectedPanelIndex(-1)));var o=e.indexOf(t);-1!==o&&(n&&n.isFocused(!1),t.isFocused(!0),this.selectedPanelIndex(o))}},a.prototype.panel=function(t,e,n){var o=this.panels(),i=t*this.colLength()+e;if("undefined"==typeof n)return o[i];var r=o[i];if(r&&(r===this.selectedPanel()&&this.selectedPanel(null),r.parentElement(null)),n){var s=n.width();n.x(e*s),n.y(t*s),n.parentElement(this.element())}o[i]=n},a.prototype.removePanel=function(t){var e=this.panelPosition(t);this.panel(e.row,e.col,null)},a.prototype.reset=function(){for(var t=this.rowLength(),e=this.colLength(),n=0;t>n;n++)for(var o=0;e>o;o++){var i,r=0===n,l=o===e-1,a=n===t-1,h=0===o;if(r||l||a||h){var c=r&&h||r&&l||a&&h||a&&l,p=Math.random()<.5;i=new s({width:8,color:s.COLOR_NONE,joints:[!c&&a&&p,!c&&h&&p,!c&&r&&p,!c&&l&&p],isFixed:!0})}else i=null;this.panel(n,o,i)}},a.prototype.isValidFormation=function(t,e,n,o,i){return e&&t.hasJoint(s.JOINT_TOP)!==e.hasJoint(s.JOINT_BOTTOM)?!1:n&&t.hasJoint(s.JOINT_RIGHT)!==n.hasJoint(s.JOINT_LEFT)?!1:o&&t.hasJoint(s.JOINT_BOTTOM)!==o.hasJoint(s.JOINT_TOP)?!1:i&&t.hasJoint(s.JOINT_LEFT)!==i.hasJoint(s.JOINT_RIGHT)?!1:!0},a.prototype.connectedPanels=function(t){var e=this.panelPosition(t),n=e.row,o=e.col,i=this.panel(n-1,o),r=this.panel(n,o+1),l=this.panel(n+1,o),a=this.panel(n,o-1),h=[];return i&&t.hasJoint(s.JOINT_TOP)&&i.hasJoint(s.JOINT_BOTTOM)&&h.push(i),r&&t.hasJoint(s.JOINT_RIGHT)&&r.hasJoint(s.JOINT_LEFT)&&h.push(r),l&&t.hasJoint(s.JOINT_BOTTOM)&&l.hasJoint(s.JOINT_TOP)&&h.push(l),a&&t.hasJoint(s.JOINT_LEFT)&&a.hasJoint(s.JOINT_RIGHT)&&h.push(a),h},a.prototype.isAllJointsConnected=function(t){var e=this.connectedPanels(t);return t.joints().filter(i.identity).length===e.length},a.prototype.chainList=function(t){for(var e=[],n=[],o=[t];0!==o.length;)e.push(o),n=n.concat(o),o=i.unique(i.flatten(o.map(function(t){return this.connectedPanels(t).filter(function(e){return e.color()===t.color()&&-1===n.indexOf(e)})}.bind(this))));return 1===e.length?[]:e},a.prototype.hasEmptyPosition=function(){for(var t=this.rowLength(),e=this.colLength(),n=1;t-1>n;n++)for(var o=1;e-1>o;o++)if(!this.panel(n,o)){var i=this.panel(n-1,o),r=this.panel(n,o+1),l=this.panel(n+1,o),a=this.panel(n,o-1);if(i.hasJoint(s.JOINT_BOTTOM)||r.hasJoint(s.JOINT_LEFT)||l.hasJoint(s.JOINT_TOP)||a.hasJoint(s.JOINT_RIGHT))return!0}return!1},a.prototype.canSetAnyPosition=function(t){for(var e=this.rowLength(),n=this.colLength(),o=new l(t.props()),i=1;e-1>i;i++)for(var r=1;n-1>r;r++)if(!this.panel(i,r))for(var s=this.panel(i-1,r),a=this.panel(i,r+1),h=this.panel(i+1,r),c=this.panel(i,r-1),p=0;4>p;p++){if(this.isValidFormation(o,s,a,h,c))return!0;o.rotate()}return!1},a.prototype.onpoint=function(t){var e=r.rect(this.element()),n=r.clientPoint(t,{x:e.left,y:e.top}),o=e.width/8,i=Math.floor(n.y/o),s=Math.floor(n.x/o);0>i||i>this.rowLength()-1||0>s||s>this.colLength()-1||(r.stop(t),this.pointer(i,s))},"undefined"!=typeof e&&e.exports?e.exports=a:n.Board=a}(this.app||(this.app={}))},{"../dom.js":6,"../helper.js":7,"./panel.js":4,jcore:void 0}],3:[function(t,e,n){!function(n){"use strict";var o=t("jcore"),i=n.helper||t("../helper.js"),r=n.dom||t("../dom.js"),s=n.Panel||t("./panel.js"),l=function(){this.erase=0,this.chain=0,this.fix=0};l.prototype.total=function(){return 100*this.erase+50*this.chain+300*this.fix};var a=i.inherits(function(t){a.super_.call(this),this.color=this.prop(t.color),this.panels=this.prop(new Array(3)),this.selectedPanelIndex=this.prop(-1),this.score=this.prop(new l),this.disabled=this.prop(!0),this.okDisabled=this.prop(!0),this.backDisabled=this.prop(!0),this.element=this.prop(t.element),this.okExecutor=t.okExecutor,this.backExecutor=t.backExecutor,r.on(this.okButtonElement(),"click",function(){this.okExecutor()}.bind(this)),r.on(this.backButtonElement(),"click",function(){this.backExecutor()}.bind(this)),r.on(this.slotWrapperElement(),r.eventType("start"),function(t){var e=this.panels(),n=!e[0]||!e[1]||!e[2];if(!n){var o=+r.data(r.target(t),"index");isNaN(o)||(r.stop(t),this.selectedPanel(e[o]))}}.bind(this)),r.on(r.doc(),r.eventType("start"),function(t){r.target(t)!==this.okButtonElement()&&this.selectedPanel(null)}.bind(this))},o.Component);a.prototype.okButtonElement=function(){return r.child(this.element(),1,0)},a.prototype.backButtonElement=function(){return r.child(this.element(),1,1)},a.prototype.panelColor=function(){switch(this.color()){case a.COLOR_WHITE:return s.COLOR_WHITE;case a.COLOR_BLACK:return s.COLOR_BLACK}},a.prototype.selectedPanel=function(t){var e=this.panels(),n=e[this.selectedPanelIndex()]||null;if("undefined"==typeof t)return n;if(t!==n){if(null===t)return void(n&&(n.isFocused(!1),this.selectedPanelIndex(-1)));var o=e.indexOf(t);-1!==o&&(n&&n.isFocused(!1),t.isFocused(!0),this.selectedPanelIndex(o))}},a.prototype.totalScore=function(){return this.score().total()},a.prototype.slotWrapperElement=function(){return r.child(this.element(),2,0)},a.prototype.slotElement=function(t){return r.child(this.element(),2,0,t)},a.prototype.scoreEraseElement=function(){return r.child(this.element(),3,0,2)},a.prototype.scoreChainElement=function(){return r.child(this.element(),3,1,2)},a.prototype.scoreFixElement=function(){return r.child(this.element(),3,2,2)},a.prototype.panel=function(t,e){var n=this.panels();if("undefined"==typeof e)return n[t];var o=n[t];o&&(o===this.selectedPanel()&&this.selectedPanel(null),o.parentElement(null)),e&&e.parentElement(this.slotElement(t)),n[t]=e},a.prototype.removePanel=function(t){this.panel(this.panels().indexOf(t),null)},a.prototype.emptySlotIndex=function(){for(var t=this.panels(),e=0,n=t.length;n>e;e++)if(!t[e])return e;return-1},a.prototype.fillEmptySlot=function(){var t=this.emptySlotIndex();-1!==t&&this.panel(t,new s({width:8,color:this.panelColor(),joints:i.sample(s.JOINTS_PATTERN_LIST),isFixed:!1}))},a.prototype.incrementScore=function(t){this.score()[t]++,this.markDirty()},a.prototype.reset=function(){for(var t=this.panels(),e=0,n=t.length;n>e;e++)t[e]&&this.panel(e,null);this.fillEmptySlot(),this.fillEmptySlot(),this.score(new l)},a.prototype.redraw=function(){this.disabled()?r.addClass(this.element(),"disabled"):r.removeClass(this.element(),"disabled"),r.disabled(this.okButtonElement(),this.okDisabled()),r.disabled(this.backButtonElement(),this.backDisabled());var t=this.score();r.text(this.scoreEraseElement(),t.erase),r.text(this.scoreChainElement(),t.chain),r.text(this.scoreFixElement(),t.fix)},a.COLOR_WHITE="white",a.COLOR_BLACK="black",a.SCORE_TYPE_ERASE="erase",a.SCORE_TYPE_CHAIN="chain",a.SCORE_TYPE_FIX="fix","undefined"!=typeof e&&e.exports?e.exports=a:n.ControllerComponent=a}(this.app||(this.app={}))},{"../dom.js":6,"../helper.js":7,"./panel.js":4,jcore:void 0}],4:[function(t,e,n){!function(n){"use strict";var o=t("jcore"),i=n.helper||t("../helper.js"),r=n.dom||t("../dom.js"),s=i.inherits(function(t){s.super_.call(this),this.x=this.prop(0),this.y=this.prop(0),this.width=this.prop(t.width),this.color=this.prop(t.color),this.joints=this.prop(t.joints.slice()),this.isFixed=this.prop(t.isFixed),this.isFocused=this.prop(!1),this.element=this.prop(null),this.parentElement=this.prop(null)},o.Component);s.prototype.props=function(){return{width:this.width(),color:this.color(),joints:this.joints().slice(),isFixed:this.isFixed()}},s.prototype.hasJoint=function(t){return this.joints()[t]},s.prototype.rotate=function(){var t=this.joints();t.unshift(t.pop()),this.markDirty()},s.prototype.rotateWithAnimation=function(){return new Promise(function(t,e){var n=this.element();if(r.hasClass(n,"panel-rotate"))return void e();r.addClass(n,"panel-rotate");var o=function(){r.off(n,"transitionend",o),r.removeClass(n,"panel-rotate"),this.rotate(),t()}.bind(this);r.on(n,"transitionend",o);var i="translate("+this.x()+"rem, "+this.y()+"rem) rotate(90deg)";r.css(n,{transform:i,webkitTransform:i})}.bind(this))},s.prototype.resetRotation=function(){for(var t=s.JOINTS_PATTERN_LIST,e=0;4>e;e++){for(var n=this.joints(),o=0,r=t.length;r>o;o++){var l=t[o];if(i.deepEqual(n,l))return}this.rotate()}},s.prototype.flash=function(t){return new Promise(function(e,n){var o=this.element();r.data(o,"flashColor")&&r.data(o,"flashColor",null);var i=function(){r.off(o,"transitionend",i),e()};r.on(o,"transitionend",i),r.data(o,"flashColor",t),setTimeout(function(){r.data(o,"flashColor",null)},1e3/60)}.bind(this))},s.prototype.gradateColor=function(t){return new Promise(function(e,n){var o=this.color();if(o===s.COLOR_NONE)return void n();if(o===t)return void e();var i=this.element();if(r.hasClass(i,"panel-change-color"))return void n();r.addClass(i,"panel-change-color");var l=function(){r.off(i,"transitionend",l),r.removeClass(i,"panel-change-color"),e()}.bind(this);r.on(i,"transitionend",l),o===s.COLOR_WHITE||o===s.COLOR_BLACK?this.color(s.COLOR_GRAY):o===s.COLOR_GRAY&&this.color(t)}.bind(this))},s.prototype.redraw=function(){var t=this.element(),e=this.parentElement();if(e||t){if(e&&!t)return t=r.el("<div>"),r.addClass(t,"panel"),r.html(t,['<div class="panel-back-circle"></div>','<div class="panel-back-joint-top"></div>','<div class="panel-back-joint-right"></div>','<div class="panel-back-joint-bottom"></div>','<div class="panel-back-joint-left"></div>','<div class="panel-front-joint-top"></div>','<div class="panel-front-joint-right"></div>','<div class="panel-front-joint-bottom"></div>','<div class="panel-front-joint-left"></div>','<div class="panel-front-circle"></div>'].join("")),this.element(t),this.redraw(),void r.append(e,t);if(!e&&t)return r.remove(t),void this.element(null);var n="translate("+this.x()+"rem, "+this.y()+"rem)";r.css(t,{height:this.width()+"rem",transform:n,webkitTransform:n,width:this.width()+"rem"}),r.data(t,"color",this.color()),["top","right","bottom","left"].forEach(function(e,n){this.joints()[n]?r.addClass(t,"panel-joint-"+e):r.removeClass(t,"panel-joint-"+e)}.bind(this)),this.isFixed()?r.addClass(t,"panel-fixed"):r.removeClass(t,"panel-fixed"),this.isFocused()?r.addClass(t,"panel-focused"):r.removeClass(t,"panel-focused")}},s.COLOR_NONE="none",s.COLOR_WHITE="white",s.COLOR_BLACK="black",s.COLOR_GRAY="gray",s.JOINT_TOP=0,s.JOINT_RIGHT=1,s.JOINT_BOTTOM=2,s.JOINT_LEFT=3,s.JOINTS_PATTERN_LIST=[[!0,!1,!1,!1],[!0,!0,!1,!1],[!0,!1,!0,!1],[!0,!0,!0,!1],[!0,!0,!0,!0]],s.FLASH_COLOR_RED="red",s.FLASH_COLOR_YELLOW="yellow",s.FLASH_COLOR_GREEN="green","undefined"!=typeof e&&e.exports?e.exports=s:n.Panel=s}(this.app||(this.app={}))},{"../dom.js":6,"../helper.js":7,jcore:void 0}],5:[function(t,e,n){!function(n){"use strict";var o=t("jcore"),i=n.helper||t("../helper.js"),r=n.dom||t("../dom.js"),s=i.inherits(function(t){s.super_.call(this),this.widthPerFontSize=this.prop(t.widthPerFontSize),this.heightPerFontSize=this.prop(t.heightPerFontSize),this.disabled=this.prop(!1),this.initialized=this.prop(!1),this.element=this.prop(t.element),r.on(r.win(),"resize",function(){this.markDirty()}.bind(this)),r.on(r.win(),"orientationchange",function(){this.markDirty()}.bind(this)),this.markDirty()},o.Component);s.prototype.redraw=function(){var t,e=this.element(),n=this.widthPerFontSize(),o=this.heightPerFontSize(),i=r.rect(e),s=i.width,l=i.height,a=s/l,h=n/o;t=h>a?s/n:l/o,r.css(e,{fontSize:t+"px"}),this.disabled()?r.addClass(e,"disabled"):r.removeClass(e,"disabled"),this.initialized()||(r.removeClass(e,"hide"),this.initialized(!0))},"undefined"!=typeof e&&e.exports?e.exports=s:n.Root=s}(this.app||(this.app={}))},{"../dom.js":6,"../helper.js":7,jcore:void 0}],6:[function(t,e,n){!function(t){"use strict";var n={};n.el=function(t){return"<"===t.charAt(0)?(t=t.match(/<(.+)>/)[1],document.createElement(t)):document.querySelector(t)},n.win=function(){return window},n.doc=function(){return document},n.root=function(){return document.documentElement},n.append=function(t,e){t.appendChild(e)},n.remove=function(t){t.parentNode.removeChild(t)},n.child=function(t,e){var n=arguments.length;if(2===n)return t.children[e];for(var o=1;n>o;o++)e=arguments[o],t=t.children[e];return t},n.css=function(t,e){var n=t.style;for(var o in e)n[o]=e[o]},n.addClass=function(t,e){t.classList.add(e)},n.removeClass=function(t,e){t.classList.remove(e)},n.hasClass=function(t,e){return t.classList.contains(e)},n.data=function(t,e,n){return"undefined"==typeof n?t.dataset[e]:null===n?void(e in t.dataset&&delete t.dataset[e]):void(t.dataset[e]=n)},n.text=function(t,e){t.textContent=e},n.html=function(t,e){t.innerHTML=e},n.disabled=function(t,e){t.disabled=e},n.rect=function(t){return t.getBoundingClientRect()},n.on=function(t,e,n){t.addEventListener(e,n)},n.off=function(t,e,n){t.removeEventListener(e,n)},n.supportsTouch=function(){return"createTouch"in document},n.target=function(t){return n.supportsTouch()&&"changedTouches"in t&&(t=t.changedTouches[0]),t.target},n.clientPoint=function(t,e){return n.supportsTouch()&&(t=t.changedTouches[0]),{x:t.clientX-(e?e.x:0),y:t.clientY-(e?e.y:0)}},n.stop=function(t){t.stopPropagation()},n.eventType=function(t){var e=n.supportsTouch();switch(t){case"start":return e?"touchstart":"mousedown";case"move":return e?"touchmove":"mousemove";case"end":return e?"touchend":"mouseup"}},"undefined"!=typeof e&&e.exports?e.exports=n:t.dom=n}(this.app||(this.app={}))},{}],7:[function(t,e,n){!function(t){"use strict";var n={};n.inherits=function(t,e){return t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),t},n.identity=function(t){return t},n.sample=function(t){return t[Math.floor(Math.random()*t.length)]},n.flatten=function(t){return Array.prototype.concat.apply([],t)},n.unique=function(t){return t.filter(function(t,e,n){return n.lastIndexOf(t)===e})},n.deepEqual=function(t,e){if(t===e)return!0;if(t.length!==e.length)return!1;for(var n=0,o=t.length;o>n;n++)if(t[n]!==e[n])return!1;return!0},n.bindAll=function(t){var e=Object.getPrototypeOf(t);for(var n in e)t[n]=e[n].bind(t)},n.timeout=function(t){return new Promise(function(e){setTimeout(e,t)})},"undefined"!=typeof e&&e.exports?e.exports=n:t.helper=n}(this.app||(this.app={}))},{}],8:[function(t,e,n){!function(n){"use strict";var o=t("jcore"),i=n.helper||t("../helper.js"),r=i.inherits(function(t){this.controller=this.prop(t.controller),this.board=this.prop(t.board)},o.Relation);r.prototype.update=function(t){var e=this.controller(),n=this.board(),o=n.selectedPanel();if(o){var r=n.panelPosition(o),s=r.row,l=r.col,a=n.panel(s-1,l),h=n.panel(s,l+1),c=n.panel(s+1,l),p=n.panel(s,l-1),d=n.isValidFormation(o,a,h,c,p);e.okDisabled(!d)}else if(e.selectedPanel()){var u=e.panels().map(function(t){return n.canSetAnyPosition(t)}).some(i.identity);e.okDisabled(u)}else e.okDisabled(!0);e.backDisabled(e.disabled()||!o)},"undefined"!=typeof e&&e.exports?e.exports=r:n.ControllerBoardRelation=r}(this.app||(this.app={}))},{"../helper.js":7,jcore:void 0}],9:[function(t,e,n){!function(n){"use strict";var o=t("jcore"),i=n.helper||t("../helper.js"),r=i.inherits(function(t){this.whiteController=this.prop(t.whiteController),this.blackController=this.prop(t.blackController)},o.Relation);r.prototype.enabledController=function(){var t=this.whiteController();if(!t.disabled())return t;var e=this.blackController();return e.disabled()?void 0:e},r.prototype.disabledController=function(){var t=this.whiteController();if(t.disabled())return t;var e=this.blackController();return e.disabled()?e:void 0},r.prototype.update=function(t){var e=this.whiteController(),n=this.blackController();t===e?n.disabled(!e.disabled()):t===n&&e.disabled(!n.disabled())},"undefined"!=typeof e&&e.exports?e.exports=r:n.ControllerRelation=r}(this.app||(this.app={}))},{"../helper.js":7,jcore:void 0}]},{},[1]);